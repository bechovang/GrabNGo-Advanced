# BoT-SORT Tracker Config with ReID
# Save as: botsort_reid.yaml

tracker_type: botsort

# Detection confidence thresholds
track_high_thresh: 0.6      # High confidence → direct assignment
track_low_thresh: 0.1       # Low confidence → check in 2nd round
new_track_thresh: 0.4       # Threshold for initiating new track

# CRITICAL FOR OCCLUSION: Track buffer time
track_buffer: 60            # Keep lost tracks for 60 frames
                            # At 30fps = 2 seconds
                            # Adjust based on max occlusion duration you expect

# Spatial matching
match_thresh: 0.8           # IoU threshold for track-detection matching
fuse_score: True            # Fuse confidence score with IoU

# ===== ReID (Re-Identification) - KEY PARAMETERS =====
with_reid: True             # Enable appearance-based tracking
model: yolo11n-cls.pt       # Options:
                            #   auto = use YOLO native features (FAST)
                            #   yolo11n-cls.pt = separate classification model (SLOWER but more accurate)
                            #   Using classification model for better ReID accuracy

# Appearance-based matching thresholds
proximity_thresh: 0.3       # Min IoU before considering ReID features (giảm từ 0.5)
appearance_thresh: 0.25     # Min cosine similarity for ReID match (giảm từ 0.35)
                            # Lower = more lenient (might accept wrong matches)
                            # Higher = stricter (might miss re-identifications)

# Motion compensation (for camera pan/tilt/zoom)
gmc_method: sparseOptFlow   # Options: orb, sift, ecc, sparseOptFlow, None
                            # Helps handle camera movement to improve tracking

# Kalman Filter configuration
kalman_format: apple        # Apple Kalman filter format

# Track buffer time (frames)
# 30 FPS → 150 frames ≈ 5s (tăng từ 60)
track_buffer: 150
